# 功能模块分析

## 概述

节点管理系统包含多个功能模块，每个模块负责特定的功能。这些模块通过Vue组件和Pinia状态管理库协同工作，提供完整的节点网络管理功能。

## 核心功能模块

### 1. 网络可视化模块 (NetworkGraph)

这是系统的核心模块，负责将节点和链接以图形化方式展示。

**主要功能**：
- 使用vis-network库渲染节点网络
- 支持节点的拖拽和移动
- 支持缩放和导航
- 节点和链接的高亮显示
- 响应节点和链接的选择事件
- 支持重置视图和全屏显示
- 提供缩放控制按钮
- 支持导出网络图为图片

**技术实现**：
- 基于vis-network的网络图组件
- 与节点存储库集成，获取节点和链接数据
- 提供交互事件处理
- 实现了物理布局和自定义节点样式
- 使用vis-network的afterDrawing事件正确导出图片

### 2. 节点管理模块

负责节点的创建、编辑、删除和展示。

**主要组件**：
- NodeModal：节点编辑模态框
- NodeList：节点列表展示
- NodeTypeModal：节点类型管理模态框

**主要功能**：
- 添加新节点
- 编辑现有节点信息（名称、类型、标签、属性等）
- 删除节点
- 节点类型管理
- 节点标签管理
- 节点属性管理
- 节点列表展示和搜索

### 3. 链接管理模块

负责节点之间链接的创建、编辑和删除。

**主要组件**：
- LinkModal：链接编辑模态框
- LinkTypeModal：链接类型管理模态框

**主要功能**：
- 创建节点间的链接
- 编辑链接属性（标签、类型等）
- 删除链接
- 链接类型管理
- 链接属性管理

### 4. 搜索与过滤模块

提供对节点和链接的搜索和过滤功能。

**主要组件**：
- SearchFilter：搜索和过滤界面

**主要功能**：
- 按名称搜索节点
- 按类型过滤节点和链接
- 按标签过滤节点
- 实时过滤更新网络图显示

### 5. 层次结构管理模块

管理节点之间的层次关系。

**主要组件**：
- HierarchyManager：层次结构管理界面

**主要功能**：
- 定义节点间的父子关系
- 展示节点的层次结构
- 管理复杂的层级关系
- 支持层次结构的可视化展示

### 6. 数据管理模块

负责系统数据的整体管理。

**主要组件**：
- DataManagement：数据管理界面

**主要功能**：
- 数据导入/导出（JSON格式）
- 数据备份和恢复
- 批量操作支持
- 数据持久化管理

### 7. 设置模块

管理系统配置和用户偏好。

**主要组件**：
- Settings：系统设置界面
- HighlightSettings：高亮设置
- TagManager：标签管理
- TypeManager：类型管理
- NodeTypeModal/LinkTypeModal：类型编辑模态框

**主要功能**：
- 系统主题切换（日间/夜间模式）
- 高亮规则配置
- 节点/链接类型管理
- 标签管理
- 类型颜色和图标配置

## 状态管理模块

系统使用Pinia作为状态管理库，主要包括以下存储模块：

### 1. 节点存储 (nodes.js)

管理节点和链接的数据状态。

**主要功能**：
- 存储所有节点和链接数据
- 管理模态框的打开/关闭状态
- 提供数据操作方法（添加、编辑、删除节点/链接）
- 提供节点和链接的查询方法
- 管理选中节点状态

### 2. 主题存储 (theme.js)

管理系统的主题设置。

**主要功能**：
- 存储当前主题（日间/夜间）
- 提供主题切换功能
- 主题状态持久化

### 3. 高亮存储 (highlight.js)

管理节点和链接的高亮设置。

**主要功能**：
- 存储高亮配置
- 提供高亮规则管理
- 控制网络图中的高亮显示

### 4. 类型存储 (types.js)

管理节点和链接的类型定义。

**主要功能**：
- 存储节点类型定义（包含颜色、图标等属性）
- 存储链接类型定义（包含颜色、样式等属性）
- 提供类型管理功能（添加、编辑、删除类型）
- 提供类型查询方法

## 用户界面模块

### 1. 主界面 (App.vue)

应用的根组件，负责整体布局和导航。

**主要功能**：
- 页面布局管理（标题栏、侧边栏、主内容区）
- 导航按钮管理（添加节点、添加关系、层次结构等）
- 组件状态管理（设置界面、数据管理界面、层次结构界面的显示控制）
- 全局事件处理
- 提供全局导出图片功能按钮

### 2. 响应式设计

系统支持多种屏幕尺寸：

- 在大屏幕（md及以上）上显示侧边栏
- 在小屏幕上隐藏侧边栏，通过按钮访问功能
- 自适应不同屏幕尺寸的组件布局
- 触摸友好的交互设计

## 数据持久化

### 1. 本地存储

系统使用浏览器的localStorage进行数据持久化：

- 节点和链接数据存储
- 类型定义存储
- 主题设置存储
- 高亮设置存储

### 2. 导入导出

- 支持JSON格式的数据导入导出
- 提供数据备份和恢复功能
- 支持批量数据操作
- 支持网络图导出为PNG图片